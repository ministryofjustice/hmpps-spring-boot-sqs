# 7.0.0

## Change to the Application Insights spans:

1. The `AppRequests` messages now contain the queue name in the `Source` field.
2. The `AppDependencies` messages now contain the queue / topic name in the `Target` field and the `DependencyType` is
   set to `Queue Message | aws_sqs` when sending a SQS message or `Queue Message | aws.sns` when publishing to an SNS
   topic.

Note that the `AppDependencies` change is a breaking change as it changes two of the fields:

1. `Target` was previously set to the same as `Name`, so normally `PUBLISH <event type>`.
2. `DependencyType` was previously set to `InProc`, but now starts with `Queue Message`.

Any Log Analytics queries that previously relied on these fields will need to be updated.

## Switch from Jackson 2 to Jackson 3 for internally parsing messages

This will potentially causing parsing issues with duplicate attributes etc. Jackson 2 also defaulted numbers to be 0
even if the field was mandatory and not supplied, Jackson 3 is more strict and it causes a parsing error.

## Spring Cloud AWS SQS Listener changes

The `MessageInterceptor` now receives the message after it has been deserialized. This means that it no longer
necessarily receives a `String` and instead receives the same type as the `SQSListener`. If your `SQSListener` is
processing messages originating from SNS and you're not using a `String` type then you should switch to using the new
`SnsMessage` type. Alternatively if that is not possible then you should switch the `SQSListener` to receive a `String`
instead. The `InboundMessageListener` provides examples of the two possible options.

## Version upgrades

- io.awspring.cloud:spring-cloud-aws-sns [3.4.2 -> 4.0.0]
- io.awspring.cloud:spring-cloud-aws-sqs [3.4.2 -> 4.0.0]
- io.awspring.cloud:spring-cloud-aws-starter [3.4.2 -> 4.0.0]
- software.amazon.awssdk:bom [2.41.16 -> 2.41.20]
- software.amazon.awssdk:sns [2.41.16 -> 2.41.20]
- software.amazon.awssdk:sts [2.41.16 -> 2.41.20]
- uk.gov.justice.hmpps.gradle-spring-boot:uk.gov.justice.hmpps.gradle-spring-boot.gradle.plugin [10.0.2 -> 10.0.3]
